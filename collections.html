<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<title>Collections — Eclaboucles</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="style.css">

<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-YXD6JPZJWC"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  
  gtag('config', 'G-YXD6JPZJWC');
</script>

</head>

<body>

<nav>
  <a href="index.html">Accueil</a>
  <a href="marque.html">La Marque</a>
  <a href="collections.html">Collections</a>
  <a href="gallery.html">Gallery</a>
  <a href="contact.html">Contact</a>

  <!-- Onglet panier à droite -->
  <div id="nav-cart" style="float:right; margin-left: auto;">
    <a href="#" id="open-cart">Panier (<span id="nav-cart-count">0</span>)</a>
  </div>

  <!-- Fenêtre panier flottante -->
<div id="cart-modal" style="display:none; position:fixed; top:60px; right:20px; width:350px; max-height:80vh; overflow-y:auto; background:#fff; border:1px solid #ccc; padding:15px; box-shadow:0 2px 10px rgba(0,0,0,0.3); z-index:1000;">
  <h3>Mon Panier</h3>
  <div id="cart-items">
    <p>Votre panier est vide.</p>
  </div>
  <p><strong>Total : </strong><span id="cart-total">0</span> €</p>
  <button id="clear-cart">Vider le panier</button>
  <button id="close-cart">Fermer</button>
</div>

</nav>

<header class="page-header">
  <h1>Les collections</h1>
  <p>Découvrez les univers Eclaboucles</p>
</header>

<section class="collection-grid">

  <a href="blue-marble.html" class="collection-card">
    <img src="images/blue-marble-cover.jpg">
    <h3>Blue Marble</h3>
  </a>

  <a href="tournesols.html" class="collection-card">
    <img src="images/tournesols-cover.jpg">
    <h3>Tournesols</h3>
  </a>

</section>

<footer>© 2026 Eclaboucles</footer>

<script>
// --- Panier global avec LocalStorage ---
const navCartCount = document.getElementById("nav-cart-count");
const cartItemsDiv = document.getElementById("cart-items");
const cartTotalEl = document.getElementById("cart-total");
const openCartBtn = document.getElementById("open-cart");
const closeCartBtn = document.getElementById("close-cart");
const clearCartBtn = document.getElementById("clear-cart");
const cartModal = document.getElementById("cart-modal");

// Récupérer le panier depuis LocalStorage ou créer un tableau vide
function getCart(){
  return JSON.parse(localStorage.getItem("cart")) || [];
}

// Sauvegarder le panier dans LocalStorage
function saveCart(cart){
  localStorage.setItem("cart", JSON.stringify(cart));
}

// Affichage du panier
function renderCart(){
  const cart = getCart();
  cartItemsDiv.innerHTML = "";
  if(cart.length === 0){
    cartItemsDiv.innerHTML = "<p>Votre panier est vide.</p>";
    cartTotalEl.textContent = "0";
    navCartCount.textContent = "0";
    return;
  }

  const ul = document.createElement("ul");
  let total = 0;

  cart.forEach((item,index)=>{
    const li = document.createElement("li");
    li.innerHTML = `
      <strong>${item.name}</strong><br>
      ${item.description}<br>
      Prix: ${item.price.toFixed(2)} €<br>
      Quantité: <input type="number" min="1" value="${item.quantity}" data-index="${index}" class="item-qty" style="width:50px;">
      <button data-index="${index}" class="remove-item">Supprimer</button>
    `;
    ul.appendChild(li);
    total += item.price * item.quantity;
  });

  cartItemsDiv.appendChild(ul);
  cartTotalEl.textContent = total.toFixed(2);
  navCartCount.textContent = cart.reduce((sum,i)=>sum+i.quantity,0);

  // Changement quantité
  document.querySelectorAll(".item-qty").forEach(input=>{
    input.addEventListener("change", e=>{
      const idx = e.target.dataset.index;
      const val = parseInt(e.target.value);
      const cart = getCart();
      if(val < 1){ e.target.value = 1; return; }
      cart[idx].quantity = val;
      saveCart(cart);
      renderCart();
    });
  });

  // Supprimer un article
  document.querySelectorAll(".remove-item").forEach(btn=>{
    btn.addEventListener("click", e=>{
      const idx = e.target.dataset.index;
      const cart = getCart();
      cart.splice(idx,1);
      saveCart(cart);
      renderCart();
    });
  });
}

// Ajouter au panier
document.querySelectorAll(".add-to-cart").forEach(btn=>{
  btn.addEventListener("click", ()=>{
    const cart = getCart(); // toujours lire le panier à jour
    const product = {
      id: btn.dataset.id,
      name: btn.dataset.name,
      description: btn.dataset.description,
      price: parseFloat(btn.dataset.price),
      quantity:1
    };

    const existing = cart.find(p=>p.id === product.id);
    if(existing){
      existing.quantity += 1;
    } else {
      cart.push(product);
    }

    saveCart(cart);
    renderCart();
    alert(`${product.name} ajouté au panier !`);
  });
});

// Ouvrir / fermer
openCartBtn.addEventListener("click", ()=> cartModal.style.display="block");
closeCartBtn.addEventListener("click", ()=> cartModal.style.display="none");

// Vider panier
clearCartBtn.addEventListener("click", ()=>{
  saveCart([]);
  renderCart();
});

// Afficher panier dès chargement
renderCart();
</script>

</body>
</html>
